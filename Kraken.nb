(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     12778,        293]
NotebookOptionsPosition[     12105,        274]
NotebookOutlinePosition[     12507,        290]
CellTagsIndexPosition[     12464,        287]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"schema", " ", "=", " ", 
    RowBox[{"Import", "[", 
     RowBox[{
     "\"\<C:\\\\Users\\\\Kirill\\\\Downloads\\\\openapi.json\>\"", ",", " ", 
      "\"\<RawJSON\>\""}], "]"}]}], ";"}], " "}]], "Code",
 CellChangeTimes->{{3.870148025015068*^9, 3.870148032846344*^9}, {
   3.8701480917892094`*^9, 3.8701481009052563`*^9}, {3.8701485304183855`*^9, 
   3.8701485356217203`*^9}, {3.870152391393091*^9, 3.8701523915173845`*^9}, 
   3.87015251710997*^9},
 CellLabel->"In[18]:=",ExpressionUUID->"08bc41b3-3330-49ea-8be3-898a79c77c1f"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"createMethod", "[", 
     RowBox[{"schema_", ",", " ", "path_"}], "]"}], " ", ":=", " ", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"info", " ", "=", " ", 
         RowBox[{"schema", "[", 
          RowBox[{"\"\<paths\>\"", ",", " ", "path"}], "]"}]}], ",", " ", 
        "\[IndentingNewLine]", "\t\t", "name", ",", " ", 
        "\[IndentingNewLine]", "\t\t", "httpMethod", ",", " ", 
        "\[IndentingNewLine]", "\t\t", "parameters"}], "\[IndentingNewLine]", 
       "\t", "}"}], ",", " ", "\[IndentingNewLine]", "\t\t", 
      RowBox[{
       RowBox[{"Print", "[", "info", "]"}], ";", " ", "\[IndentingNewLine]", 
       "\t\t", 
       RowBox[{"name", " ", "=", " ", 
        RowBox[{"\"\<Kraken\>\"", " ", "<>", " ", 
         RowBox[{"Last", "[", 
          RowBox[{"StringSplit", "[", 
           RowBox[{"path", ",", " ", "\"\</\>\""}], "]"}], "]"}]}]}], ";", 
       " ", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"httpMethod", " ", "=", " ", 
        RowBox[{"First", "[", 
         RowBox[{"Keys", "[", "info", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"parameters", " ", "=", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"KeyExistsQ", "[", 
           RowBox[{
            RowBox[{"info", "[", "httpMethod", "]"}], ",", " ", 
            "\"\<parameters\>\""}], "]"}], ",", " ", 
          RowBox[{"info", "[", 
           RowBox[{"httpMethod", ",", " ", "\"\<parameters\>\""}], "]"}], ",",
           " ", 
          RowBox[{"{", "}"}]}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
       "\t\t", 
       RowBox[{"parameters", " ", "=", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MatchQ", "[", 
           RowBox[{"parameters", ",", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"<|", 
               RowBox[{"\"\<$ref\>\"", " ", "->", " ", "_"}], "|>"}], ",", 
              " ", "___"}], "}"}]}], "]"}], ",", " ", "\[IndentingNewLine]", 
          "\t\t", 
          RowBox[{"schema", "[", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"Rest", "[", 
             RowBox[{"StringSplit", "[", 
              RowBox[{
               RowBox[{"parameters", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", " ", "\"\<$ref\>\""}], "]"}], "]"}], ",", 
               " ", "\"\</\>\""}], "]"}], "]"}]}], "]"}], ",", " ", 
          "\[IndentingNewLine]", "\t\t", "parameters"}], 
         "\[IndentingNewLine]", "\t", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", "\t", "\n", "\t", 
       RowBox[{"<|", "\[IndentingNewLine]", "\t\t", 
        RowBox[{
         RowBox[{"\"\<name\>\"", " ", "->", " ", "name"}], ",", " ", 
         "\[IndentingNewLine]", "\t\t", 
         RowBox[{"\"\<httpMethod\>\"", " ", "->", " ", "httpMethod"}], ",", 
         " ", "\[IndentingNewLine]", "\t\t", 
         RowBox[{"\"\<parameters\>\"", " ", "->", " ", "parameters"}], ",", 
         " ", "\[IndentingNewLine]", "\t\t", 
         RowBox[{"\"\<path\>\"", " ", "->", " ", "path"}]}], " ", 
        "\[IndentingNewLine]", "\t", "|>"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], " ", "\n"}], "\[IndentingNewLine]", 
 RowBox[{"createMethod", "[", 
  RowBox[{"schema", ",", " ", "\"\</public/Ticker\>\""}], "]"}]}], "Code",
 CellChangeTimes->{{3.8701525214954767`*^9, 3.8701526265602827`*^9}, {
   3.8701526826065807`*^9, 3.870152917474676*^9}, {3.8701542520367126`*^9, 
   3.8701542809282565`*^9}, {3.8701543527616677`*^9, 
   3.8701544100197315`*^9}, {3.87015445457545*^9, 3.870154460182871*^9}, {
   3.8701547110610733`*^9, 3.870154722461401*^9}, {3.8701557971215343`*^9, 
   3.870155922359127*^9}, {3.8701559724050465`*^9, 3.870155972980586*^9}, 
   3.8701560628618317`*^9, {3.871028757450158*^9, 3.871028918149534*^9}, {
   3.871029611423505*^9, 3.8710296674735947`*^9}, {3.8710296982930603`*^9, 
   3.8710297161734824`*^9}, {3.8710297576437073`*^9, 3.871029773163679*^9}},
 CellLabel->"In[37]:=",ExpressionUUID->"a18494ba-b26d-4468-9b46-dc6f19215a30"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{"\<\"get\"\>", "\[Rule]", 
   RowBox[{"\[LeftAssociation]", 
    RowBox[{
     RowBox[{"\<\"summary\"\>", "\[Rule]", "\<\"Get Ticker Information\"\>"}],
      ",", 
     RowBox[{"\<\"description\"\>", 
      "\[Rule]", "\<\"Note: Today's prices start at midnight UTC\"\>"}], ",", 
     RowBox[{"\<\"tags\"\>", "\[Rule]", 
      RowBox[{"{", "\<\"Market Data\"\>", "}"}]}], ",", 
     RowBox[{"\<\"operationId\"\>", 
      "\[Rule]", "\<\"getTickerInformation\"\>"}], ",", 
     RowBox[{"\<\"security\"\>", "\[Rule]", 
      RowBox[{"{", "}"}]}], ",", 
     RowBox[{"\<\"parameters\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\[LeftAssociation]", 
        RowBox[{"\<\"$ref\"\>", 
         "\[Rule]", "\<\"#/components/parameters/pair\"\>"}], 
        "\[RightAssociation]"}], "}"}]}], ",", 
     RowBox[{"\<\"responses\"\>", "\[Rule]", 
      RowBox[{"\[LeftAssociation]", 
       RowBox[{"\<\"200\"\>", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          
          RowBox[{"\<\"description\"\>", 
           "\[Rule]", "\<\"Ticker info retrieved.\"\>"}], ",", 
          RowBox[{"\<\"content\"\>", "\[Rule]", 
           RowBox[{"\[LeftAssociation]", 
            RowBox[{"\<\"application/json\"\>", "\[Rule]", 
             RowBox[{"\[LeftAssociation]", 
              RowBox[{"\<\"schema\"\>", "\[Rule]", 
               RowBox[{"\[LeftAssociation]", 
                RowBox[{
                 
                 RowBox[{"\<\"$ref\"\>", 
                  "\[Rule]", "\<\"#/components/schemas/ticker-2\"\>"}], ",", 
                 RowBox[{"\<\"example\"\>", "\[Rule]", 
                  RowBox[{"\[LeftAssociation]", 
                   RowBox[{
                    RowBox[{"\<\"error\"\>", "\[Rule]", 
                    RowBox[{"{", "}"}]}], ",", 
                    RowBox[{"\<\"result\"\>", "\[Rule]", 
                    RowBox[{"\[LeftAssociation]", 
                    RowBox[{"\<\"XXBTZUSD\"\>", "\[Rule]", 
                    RowBox[{"\[LeftAssociation]", 
                    RowBox[{
                    RowBox[{"\<\"a\"\>", "\[Rule]", 
                    RowBox[{"{", 
                    
                    RowBox[{"\<\"52609.60000\"\>", ",", "\<\"1\"\>", 
                    ",", "\<\"1.000\"\>"}], "}"}]}], ",", 
                    RowBox[{"\<\"b\"\>", "\[Rule]", 
                    RowBox[{"{", 
                    
                    RowBox[{"\<\"52609.50000\"\>", ",", "\<\"1\"\>", 
                    ",", "\<\"1.000\"\>"}], "}"}]}], ",", 
                    RowBox[{"\<\"c\"\>", "\[Rule]", 
                    RowBox[{"{", 
                    
                    RowBox[{"\<\"52641.10000\"\>", 
                    ",", "\<\"0.00080000\"\>"}], "}"}]}], ",", 
                    RowBox[{"\<\"v\"\>", "\[Rule]", 
                    RowBox[{"{", 
                    
                    RowBox[{"\<\"1920.83610601\"\>", 
                    ",", "\<\"7954.00219674\"\>"}], "}"}]}], ",", 
                    RowBox[{"\<\"p\"\>", "\[Rule]", 
                    RowBox[{"{", 
                    
                    RowBox[{"\<\"52389.94668\"\>", 
                    ",", "\<\"54022.90683\"\>"}], "}"}]}], ",", 
                    RowBox[{"\<\"t\"\>", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"23329", ",", "80463"}], "}"}]}], ",", 
                    RowBox[{"\<\"l\"\>", "\[Rule]", 
                    RowBox[{"{", 
                    
                    RowBox[{"\<\"51513.90000\"\>", 
                    ",", "\<\"51513.90000\"\>"}], "}"}]}], ",", 
                    RowBox[{"\<\"h\"\>", "\[Rule]", 
                    RowBox[{"{", 
                    
                    RowBox[{"\<\"53219.90000\"\>", 
                    ",", "\<\"57200.00000\"\>"}], "}"}]}], ",", 
                    RowBox[{"\<\"o\"\>", "\[Rule]", "\<\"52280.40000\"\>"}]}],
                     "\[RightAssociation]"}]}], "\[RightAssociation]"}]}]}], 
                   "\[RightAssociation]"}]}]}], "\[RightAssociation]"}]}], 
              "\[RightAssociation]"}]}], "\[RightAssociation]"}]}]}], 
         "\[RightAssociation]"}]}], "\[RightAssociation]"}]}], ",", 
     RowBox[{"\<\"x-codeSamples\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"\<\"lang\"\>", "\[Rule]", "\<\"cURL\"\>"}], ",", 
          
          RowBox[{"\<\"source\"\>", 
           "\[Rule]", "\<\"curl \
\\\"https://api.kraken.com/0/public/Ticker?pair=XBTUSD\\\"\\n\"\>"}]}], 
         "\[RightAssociation]"}], ",", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"\<\"lang\"\>", "\[Rule]", "\<\"Python\"\>"}], ",", 
          
          RowBox[{"\<\"source\"\>", 
           "\[Rule]", "\<\"import requests\\n\\nresp = \
requests.get('https://api.kraken.com/0/public/Ticker?pair=XBTUSD')\\n\\nprint(\
resp.json())\\n\"\>"}]}], "\[RightAssociation]"}]}], "}"}]}]}], 
    "\[RightAssociation]"}]}], "\[RightAssociation]"}]], "Print",
 CellChangeTimes->{3.8710297735833044`*^9},
 CellLabel->
  "During evaluation of \
In[37]:=",ExpressionUUID->"6df98abb-389a-42f7-b240-fbd57a601862"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"name\"\>", "\[Rule]", "\<\"KrakenTicker\"\>"}], ",", 
   RowBox[{"\<\"httpMethod\"\>", "\[Rule]", "\<\"get\"\>"}], ",", 
   RowBox[{"\<\"parameters\"\>", "\[Rule]", 
    RowBox[{"\[LeftAssociation]", 
     RowBox[{
      RowBox[{"\<\"in\"\>", "\[Rule]", "\<\"query\"\>"}], ",", 
      RowBox[{"\<\"name\"\>", "\[Rule]", "\<\"pair\"\>"}], ",", 
      RowBox[{"\<\"description\"\>", 
       "\[Rule]", "\<\"Asset pair to get data for\"\>"}], ",", 
      RowBox[{"\<\"required\"\>", "\[Rule]", "True"}], ",", 
      RowBox[{"\<\"schema\"\>", "\[Rule]", 
       RowBox[{"\[LeftAssociation]", 
        RowBox[{"\<\"type\"\>", "\[Rule]", "\<\"string\"\>"}], 
        "\[RightAssociation]"}]}], ",", 
      RowBox[{"\<\"example\"\>", "\[Rule]", "\<\"XBTUSD\"\>"}]}], 
     "\[RightAssociation]"}]}], ",", 
   RowBox[{"\<\"path\"\>", "\[Rule]", "\<\"/public/Ticker\"\>"}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{
  3.8701528579405317`*^9, 3.8701529197944155`*^9, {3.8701542611973066`*^9, 
   3.8701542814490166`*^9}, 3.8701543585645885`*^9, 3.8701544119130125`*^9, 
   3.870154460485522*^9, {3.8701559108925047`*^9, 3.8701559225928564`*^9}, 
   3.8701559740093803`*^9, 3.870156063158429*^9, 3.8710247661481757`*^9, {
   3.871028751654531*^9, 3.8710288446050386`*^9}, 3.8710289190137196`*^9, 
   3.8710296705838933`*^9, {3.871029764453336*^9, 3.8710297735935645`*^9}},
 CellLabel->"Out[38]=",ExpressionUUID->"4338db42-8ba4-4bc1-ab6e-85c6e2afc419"]
}, Open  ]]
},
WindowSize->{1920, 989},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
FrontEndVersion->"13.0 for Microsoft Windows (64-bit) (February 4, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"059fe8d0-44d3-491c-b2ab-deffc2c69bf2"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 576, 12, 52, "Code",ExpressionUUID->"08bc41b3-3330-49ea-8be3-898a79c77c1f"],
Cell[CellGroupData[{
Cell[1159, 36, 4164, 88, 466, "Code",ExpressionUUID->"a18494ba-b26d-4468-9b46-dc6f19215a30"],
Cell[5326, 126, 5228, 115, 197, "Print",ExpressionUUID->"6df98abb-389a-42f7-b240-fbd57a601862"],
Cell[10557, 243, 1532, 28, 33, "Output",ExpressionUUID->"4338db42-8ba4-4bc1-ab6e-85c6e2afc419"]
}, Open  ]]
}
]
*)

